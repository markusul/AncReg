<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ancestor Regression — AncReg • AncReg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ancestor Regression — AncReg"><meta name="description" content="This function performs ancestor regression for linear structural equation models (Schultheiss et al. 2024)
 and
vector autoregressive models (Schultheiss and Bühlmann 2023)
 with explicit error control for false discovery, at least asymptomatically."><meta property="og:description" content="This function performs ancestor regression for linear structural equation models (Schultheiss et al. 2024)
 and
vector autoregressive models (Schultheiss and Bühlmann 2023)
 with explicit error control for false discovery, at least asymptomatically."><meta property="og:image" content="http://www.markus-ulmer.ch/AncReg/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AncReg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Ancestor Regression</h1>

      <div class="d-none name"><code>AncReg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs ancestor regression for linear structural equation models (Schultheiss et al. 2024)
 and
vector autoregressive models (Schultheiss and Bühlmann 2023)
 with explicit error control for false discovery, at least asymptomatically.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AncReg</span><span class="op">(</span><span class="va">x</span>, degree <span class="op">=</span> <span class="fl">0</span>, targets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A named numeric matrix containing the observational data.</p></dd>


<dt id="arg-degree">degree<a class="anchor" aria-label="anchor" href="#arg-degree"></a></dt>
<dd><p>An integer specifying the order of the SVAR process to be considered. Default is 0 for no time series.</p></dd>


<dt id="arg-targets">targets<a class="anchor" aria-label="anchor" href="#arg-targets"></a></dt>
<dd><p>A character vector specifying the variables whose ancestors should be estimated. Default is all variables.</p></dd>


<dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>A function specifying the non-linearity used in the ancestor regression. Default is a cubic function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class "AncReg" containing:</p>
<dl><dt>z.val</dt>
<dd><p>A numeric matrix of test statistics.</p></dd>

<dt>p.val</dt>
<dd><p>A numeric matrix of p-values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Schultheiss C, Bühlmann P (2023).
“Ancestor regression in linear structural equation models.”
<em>Biometrika</em>, <b>110</b>(4), 1117-1124.
ISSN 1464-3510, <a href="https://doi.org/10.1093/biomet/asad008" class="external-link">doi:10.1093/biomet/asad008</a>
, https://academic.oup.com/biomet/article-pdf/110/4/1117/53472115/asad008.pdf.<br><br> Schultheiss C, Ulmer M, Bühlmann P (2024).
“Ancestor regression in structural vector autoregressive models.”
2403.03778, <a href="https://arxiv.org/abs/2403.03778" class="external-link">https://arxiv.org/abs/2403.03778</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.AncReg.html">summary.AncReg</a></code>, <code><a href="instant_graph.html">instant_graph</a></code>, <code><a href="summary_graph.html">summary_graph</a></code>,
<code><a href="instant_p.val.html">instant_p.val</a></code>, <code><a href="summary_p.val.html">summary_p.val</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##### simulated example for inear structural equation models</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># random DAGS for simulation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co">#number of nodes</span></span></span>
<span class="r-in"><span><span class="va">DAG</span> <span class="op">&lt;-</span> <span class="fu">pcalg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pcalg/man/randomDAG.html" class="external-link">randomDAG</a></span><span class="op">(</span><span class="va">p</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span> <span class="co"># represent DAG as matrix</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># store edge weights</span></span></span>
<span class="r-in"><span>    <span class="va">B</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">DAG</span><span class="op">@</span><span class="va">edgeData</span><span class="op">@</span><span class="va">data</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">j</span>,<span class="st">"|"</span>,<span class="va">i</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># solution in terms of noise</span></span></span>
<span class="r-in"><span><span class="va">Bprime</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">ginv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="va">B</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Bprime</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit ancestor regression</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">AncReg</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Registered S3 method overwritten by 'quantmod':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   method            from</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   as.zoo.data.frame zoo </span>
<span class="r-in"><span><span class="co"># collect ancestral p-values and graph</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              A            B            C            D          E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 1.000000e+00 4.651060e-01 8.724085e-01 6.022472e-02 0.88321535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B 1.749755e-01 1.000000e+00 2.413209e-01 9.401252e-01 0.06325044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C 8.289132e-01 3.259650e-06 1.000000e+00 2.958733e-01 0.43794278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D 6.051335e-01 5.089227e-30 4.945655e-01 1.000000e+00 0.15173540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E 7.633085e-20 6.462766e-01 5.580378e-18 8.617029e-17 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A     B     C     D     E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C FALSE  TRUE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D FALSE  TRUE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E  TRUE  TRUE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.AncReg"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#compare true and estimated ancestral graph</span></span></span>
<span class="r-in"><span><span class="va">trueGraph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="fu"><a href="recAncestor.html">recAncestor</a></span><span class="op">(</span><span class="va">B</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ancGraph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trueGraph</span>, main <span class="op">=</span> <span class="st">'true ancestral graph'</span>, vertex.size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ancGraph</span>, main <span class="op">=</span> <span class="st">'Ancestor Regression'</span>, vertex.size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="AncReg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### SVAR-example with geyser timeseries</span></span></span>
<span class="r-in"><span><span class="va">geyser</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/geyser.html" class="external-link">geyser</a></span></span></span>
<span class="r-in"><span><span class="co"># shift waiting such that it is waiting after erruption</span></span></span>
<span class="r-in"><span><span class="va">geyser2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>waiting <span class="op">=</span> <span class="va">geyser</span><span class="op">$</span><span class="va">waiting</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, duration <span class="op">=</span> <span class="va">geyser</span><span class="op">$</span><span class="va">duration</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">geyser</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit ancestor regression with 6 lags considered</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">AncReg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">geyser2</span><span class="op">)</span>, degree <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inst.p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            waiting     duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting  1.0000000 0.0004811719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duration 0.5109396 1.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inst.graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          waiting duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting    FALSE     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duration   FALSE    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inst.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sum.p.val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            waiting    duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting  1.0000000 0.008733271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duration 0.1760936 1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sum.graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          waiting duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waiting    FALSE     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duration   FALSE    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary.AncReg"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># visualize instantaneous ancestry</span></span></span>
<span class="r-in"><span><span class="va">instGraph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">inst.graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">instGraph</span>, edge.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">inst.p.val</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'instantaneous effects'</span>, vertex.size <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># visualize summary of lagged ancestry</span></span></span>
<span class="r-in"><span><span class="va">sumGraph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">sum.graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sumGraph</span>, edge.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">sum.p.val</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'summary graph'</span>, vertex.size <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="AncReg-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.markus-ulmer.ch" class="external-link">Markus Ulmer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

